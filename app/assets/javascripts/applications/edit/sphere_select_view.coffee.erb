#= require applications/edit/sphere_view

class SphereSelectView
  constructor: (options = {}) ->
    @app = options.app
    @portalView = options.portalView
    $(document).ready(@onDocumentReady)

  onDocumentReady: =>
    @renderSpheres()

  renderSpheres: ->
    for sphere in window.memory.spheres
      $addSphereLink = $('.add-sphere-link')

      if $("#sphere-#{sphere.id}").length == 0
        view = new SphereView(sphere)
        html = view.render()
        $(html).insertBefore($addSphereLink)
        $("##{sphere.id}.sphere-link").click(@onSphereLinkClicked)

  onSphereLinkClicked: (e) =>
    id = parseInt(e.currentTarget.id)
    associatedSphere = _.findWhere(window.memory.spheres, { id })
    @app.setNextSphere(associatedSphere)

    @app.resetPageState()


window.SphereSelectView = SphereSelectView
